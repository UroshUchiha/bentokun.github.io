<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>

<head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>AudioStreaming Example</title>
<link href="style.css" rel="stylesheet" type="text/css">
</head>

<table border="0" width="100%" height="8" bgcolor="#eeeeee">
<tr> <td width="100%" height="1"><b><font size="2" color="#000000" face="Arial, Helvetica, sans-serif"><strong><a name=Top></a>
S60 5th Edition SDK </strong></font></b><br><i>Example Applications Guide</i></td></tr> </table>
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li id="current"><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<h1>AudioStreaming Example</h1>
<p>
<a class="el" href="index.html#Intro_sec">1. About this Example</a> <br>
<a class="el" href="index.html#Arch_sec">2. Architecture</a> <br>
<a class="el" href="index.html#Design_sec">3. Design and Implementation</a><p>
<hr>
<h2><a class="anchor" name="Intro_sec">
1. About this Example</a></h2>
Audio Streaming Example demonstrates the use of Audio Streaming API that provides functionality for recording audio stream into a buffer, and playback of the audio buffer.Also, the recorded audio stream can be saved into a file and further loaded to be played again.Sample files can be PCM encoded or AMR-NB-encoded audio files. This application is designed to run in both <b>S60 2nd Edition</b> and <b>S60 3rd Edition</b> devices.<p>
List the functionalities of the application:<ul>
<li>Play</li><li>Record</li><li>Stop</li><li>Load</li><li>Save</li><li>Encoding</li><li>Exit</li></ul>
<h3><a class="anchor" name="Sub11">
1.1 APIs demonstrated</a></h3>
<ul>
<li>CMdaAudioInputStream</li><li>CMdaAudioOutputStream</li><li>MMdaAudioInputStreamCallback</li><li>MMdaAudioOutputStreamCallback.</li></ul>
<h3><a class="anchor" name="Sub12">
1.2 Prerequisites</a></h3>
Audio Streaming API is part of the Symbian Multimedia Framework (MMF) and supported from S60 2nd Edition onwards.User is expected to have an acquaintance with the Symbian Multimedia Framework.<h3><a class="anchor" name="Sub13">
1.3 Running this example</a></h3>
Ensure the following points before building this example.<br>
 <b>MOBILE DEVICE (S60 3rd Edition)</b><br>
 Ensure that the sample.aud/amr files located at /AudioStreamExample/data have been copied to /epoc32/winscw/c/system/Apps/audiostream/ in your SDK installation directory<br>
 <br>
<b>MOBILE DEVICE (S60 2nd Edition)</b> <br>
 Ensure that the sample.aud/amr files located at /AudioStreamExample/data have been copied to /epoc32/winscw/c/system/Apps/audiostream/ in your SDK installation directory<br>
 <br>
<b>EMULATOR (S60 3rd Edition)</b><br>
 Ensure that the sample.aud/amr files located at /AudioStreamExample/data have been copied to /epoc32/winscw/c/private/e01ff1c3/ in your SDK installation directory<br>
 <br>
<b>EMULATOR (S60 2nd Edition)</b><br>
 Ensure that the sample.aud/amr files located at /AudioStreamExample/data have been copied to /epoc32/winscw/c/system/Apps/audiostream/ in your SDK installation directory<br>
<h2><a class="anchor" name="Arch_sec">
2. Architecture</a></h2>
Audio streaming example follows traditional Symbian OS Control-based architecture. <a class="el" href="class_c_audio_stream_engine.html">CAudioStreamEngine</a> is engine class which, inherits from MMdaAudioInputStreamCallback and MMdaAudioOutputStreamCallback. <a class="el" href="class_c_audio_stream_engine.html">CAudioStreamEngine</a> class defines audio functions (Play, Record, LoadFile, Stop) and the callback functions to get the error status of the audio operations.<p>
<div align="center">
<img src="AUDIOSTREAM_ENGINE.JPG" alt="AUDIOSTREAM_ENGINE.JPG">
</div>
<h2><a class="anchor" name="Design_sec">
3. Design and Implementation</a></h2>
<h3><a class="anchor" name="Sub31">
3.1 Capabilities</a></h3>
Since this example implements recording functionality, program is defined with the UserEnvironment capability.<br>
 The program capabilities are defined in the <a class="el" href="_audio_stream__s60__3rd__ed_8mmp-source.html">AudioStream_s60_3rd_ed.mmp</a> file: CAPABILITY UserEnvironment<h3><a class="anchor" name="Sub32">
3.2 Features</a></h3>
The heart of this application is <a class="el" href="class_c_audio_stream_engine.html">CAudioStreamEngine</a> class, which inherits MMdaAudioInputStreamCallback and MMdaAudioOutputStreamCallback. <a class="el" href="class_c_audio_stream_engine.html">CAudioStreamEngine</a> implements <b>CMdaAudioInputStream</b> for input stream (Recording) and <b>CMdaAudioOutputStream</b> for output stream(Playing). The important functionalities of example are discussed below.<p>
<ul>
<li><a class="el" href="class_c_audio_stream_engine.html#80ce1ac02249eb8d64361940d6f4206a">Play </a> <br>
 This operation is implemented using the out stream class CMdaAudioOutputStream, which is used to pass the audio data from buffers to output stream. This class supports following callback functions from server to notify the client:<ul>
<li><a class="el" href="class_c_audio_stream_engine.html#d954b004e833f688ccc4d53622276bc3">MaoscOpenComplete() </a> will be called when the audio streaming object is open and ready to stream data back to the audio hardware as a result of a previous call to Open().</li><li><a class="el" href="class_c_audio_stream_engine.html#02fc2ce62f96be691e899ba83ed13986">MaoscBufferCopied() </a> will be called each time audio data has been successfully copied to the lower layers of the MMF as a result of a previous ReadL().</li><li><a class="el" href="class_c_audio_stream_engine.html#390831d5030b47e70fe2e10b24a31a61">MaoscPlayComplete() </a> will be called when the audio data stream has been closed as a result of a previous Stop().</li></ul>
</li></ul>
<p>
<ul>
<li><a class="el" href="class_c_audio_stream_engine.html#0ed8b9a3b0b23104cc2f3bc72410fe8f">Record </a> <br>
 This functionality is implemented using CMdaAudioInputStream, which is used to pass audio data from audio hardware to buffer. This class supports following callback functions from server to notify the client:<ul>
<li><a class="el" href="class_c_audio_stream_engine.html#7860395c6a068eee730aea987f79e271">MaiscOpenComplete() </a> will be called when the audio streaming object is open and ready to stream data back to the user as a result of a previous call to Open().</li><li><a class="el" href="class_c_audio_stream_engine.html#0061513b928e2aeadbe9b96d04ea25b0">MaiscBufferCopied() </a> will be called multiple times while the FIFO (queued via ReadL()) is emptied. Note: Each buffer will be flagged with KErrAbort if received after Stop() on is called.</li><li><a class="el" href="class_c_audio_stream_engine.html#3f44f895684f29284631f4faac6c7a38">MaiscRecordComplete() </a> will be called once all remaining buffers have been read or after Stop() has been called</li></ul>
</li></ul>
<p>
<ul>
<li><a class="el" href="class_c_audio_stream_engine.html#78109ff8cb02d98ff75ab125fa94a8d4">Stop </a> <br>
 This function uses both CMdaAudioInputStream and CMdaAudioOutputStream classes depending upon whether the audio is recording or playing:<ul>
<li>in case of playing <b>CMdaAudioOutputStream::Stop()</b> is used and the result is notified via <a class="el" href="class_c_audio_stream_engine.html#390831d5030b47e70fe2e10b24a31a61">MaoscPlayComplete() </a></li><li>in case of recording <b>CMdaAudioInputStream::Stop()</b> is used and the result is notified via <a class="el" href="class_c_audio_stream_engine.html#3f44f895684f29284631f4faac6c7a38">MaiscRecordComplete() </a>.</li></ul>
</li></ul>
<p>
<ul>
<li><a class="el" href="class_c_audio_stream_engine.html#d5f95ec54752b45a80932269da6bcf8b">Encoding </a> <br>
 The purpose of this API is to encode the audio data. By default the audio data is encoded as PCM (Pulse-code modulation). This example also demonstrates encoding of audio data to AMR-NB (Adaptive Multi-Rate). If the AMR-NB is not supported by the platform then default PCM encoding is used. <b>CMdaAudioInputStream::SetDataTypeL(TFourCC aAudioType)</b> is used to carry out the purpose of encoding.</li></ul>
<h3><a class="anchor" name="Sub33">
3.3 MMP Files</a></h3>
This example has two mmp files, in order to support both S60 2.X and S60 3.X versions of S60 platform<ul>
<li>The MMP file for S60 2.x is: <a class="el" href="_audio_stream__s60__2nd__ed_8mmp-source.html">AudioStream_s60_2nd_ed.mmp</a></li><li>The MMP file for S60 3.x is: <a class="el" href="_audio_stream__s60__3rd__ed_8mmp-source.html">AudioStream_s60_3rd_ed.mmp</a> </li></ul>
<hr>

<table x-use-null-cells
		style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;"
		cellspacing=0
		width=100%>
  <col style="width: 50%;">
  <col style="width: 50%;">

  <tr style="x-cell-content-align: top;"
	valign=top>
  <td style="width: 50%;
			padding-right: 10px;
			padding-left: 10px;
			border-right-style: None;
			border-left-style: None;
			border-top-style: None;
			border-bottom-style: None;"
	width=50%>
  <p style="font-family: Arial;"><small style="font-size: smaller;">© Nokia 2009</small></td>
  <td style="width: 50%;
			padding-right: 10px;
			padding-left: 10px;
			border-top-style: None;
			border-bottom-style: None;
			border-right-style: None;"
	width=50%>
  <p style="text-align: right; margin-right: -4px;"
	align=right><span style="font-weight: bold;"><a href="#Top"
													title="Back to top"><img
 src="top.gif"
	x-maintain-ratio=TRUE
	alt="Back to top"
	style="border: none;
			width: 18px;
			height: 15px;
			float: none;
			border-style: none;
			border-style: none;"
	width=18
	height=15
	border=0></a></span></td></tr>
 </table>
</body>
</html>

